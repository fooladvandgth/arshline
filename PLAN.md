# برنامه پروژه (PLAN.md)

## چشم‌انداز
توسعه افزونه‌ای نسل جدید، ماژولار، امن، مقیاس‌پذیر و توسعه‌پذیر برای وردپرس جهت ساخت فرم‌های پیشرفته، آزمون، نظرسنجی و تحلیل داده‌ها با امکاناتی فراتر از پرسلاین و Gravity Forms و یکپارچه با هوش مصنوعی، پیامک، تقویم، API داینامیک و معماری مدرن.

## معماری و زیرساخت
- معماری ماژولار واقعی (هر ماژول به صورت پکیج PHP با namespace و PSR-4، بارگذاری با Composer)
- رجیستری مرکزی و Service Container سبک
- Feature Flags پیشرفته با UI مخصوص توسعه‌دهنده و ذخیره در Option/JSON
- تفکیک لایه‌ای (UI ← Application ← Domain ← Infrastructure)
- جداول اختصاصی DB و اسکیما JSON نسخه‌دار برای فرم‌ها
- سیستم Migration نسخه‌دار و امن
- صف و پردازش پس‌زمینه (Action Scheduler)، کشینگ هوشمند، خروجی استریم‌شده
- Rate Limiting، Honeypot، reCAPTCHA، امنیت ورودی و خروجی، Privacy-by-Design
- امضای وبهوک و لینک‌های دانلود امن
- ابزارهای توسعه (Monorepo، PHPCS، Rector، PHPStan، تست خودکار، CI)
- استراتژی رندر هیبرید (HTMX + گوتنبرگ)، DSL شرطی، State Machine، اعتبارسنجی دوگانه
- دسترس‌پذیری (A11y)، تم‌ساز با CSS Variables و سیستم Token
- لایه AI با آداپتر، کنترل هزینه و امنیت داده، Prompt Templates نسخه‌دار
- Export Pipeline یکتا، PDF/DOCX با قالب، اشتراک امن و سینک دوطرفه Google Sheets
- لایه Transport برای پیامک/ایمیل، 2FA/OTP، ویرایشگر Template اعلان‌ها
- Event Schema، کارت‌های تحلیلی، Webhook، Batch & Retry
- REST API نسخه‌دار، Webhook، Hook System کامل، SDK سبک
- i18n و RTL کامل، تقویم شمسی افزونه‌ای
- Audit Log، Error Reporting، Self-Diagnostics

## فازها
۱. تحلیل نیازمندی‌ها و طراحی معماری (انجام شد)
۲. طراحی ساختار پوشه/فایل، شِمای پایگاه داده و معماری ماژولار (انجام شد)
۳. تهیه و به‌روزرسانی مستندات پروژه (PLAN, CHECKLIST, PROGRESS_LOG)
۴. پیاده‌سازی MVP Core (تعریف فرم ساده از JSON، اعتبارسنجی و ذخیره، تست موتور شرطی/ذخیره‌سازی/Queue)
۵. پیاده‌سازی هسته افزونه و معماری ماژولار (feature flags، امنیت، i18n، RTL، Multi-site)
۵.۱. طراحی و پیاده‌سازی داشبورد اختصاصی افزونه (نسخه‌دار و مستقل از داشبورد وردپرس)
۵.۲. طراحی داشبورد بسیار مدرن و زیبا با Placeholder همه امکانات افزونه (اولویت اول توسعه)
۶. ساخت فرم‌ساز بصری (درگ و دراپ، HTMX، فیلدهای پیشرفته، شرطی، چندمرحله‌ای، تایمر، Undo/Redo، Draft/Publish، Versioning)
	- تکمیل: درگ‌انداپ نرم و پایدار با Placeholder ملایم و رهاکردن بعد از آخرین آیتم
	- تکمیل: ابزارهای ثابت خوش‌آمد/تشکر با جایگاه قفل‌شده و ادیتور اختصاصی
	- تکمیل: دکمه‌های پیش‌نمایش در بیلدر و ادیتور، شماره‌گذاری درست صرفاً برای سؤالات
	- تکمیل: حذف تکی، انتخاب چندتایی و حذف گروهی با انیمیشن نرم
۷. پیاده‌سازی انواع فرم (عمومی، رمزدار، لاگین، زمان‌بندی، محدودیت تعداد، پیش‌تنظیم‌های آماده)
۸. پیاده‌سازی خروجی و اشتراک‌گذاری امن (Export Pipeline، Excel, CSV, PDF, DOCX, JSON، سینک با Google Sheets/Drive، لینک‌های امضاشده)
۹. یکپارچه‌سازی هوش مصنوعی (پیشنهاد فیلد/گزینه، خلاصه‌سازی پاسخ‌ها، Insightهای پیشرفته، داشبورد تحلیلی هوشمند)
۱۰. اتصال پیامک و ایمیل (اطلاع‌رسانی، احراز هویت دو مرحله‌ای، ویرایشگر Template اعلان‌ها)
۱۱. ساخت داشبورد تحلیلی پیشرفته و سازنده قالب (قالب‌های آماده و قابل ویرایش، هدر/فوتر/لوگو، سیستم Token)
۱۲. توسعه API داینامیک و مستند (REST نسخه‌دار، Webhook، Hook System، SDK سبک، مستند Swagger/OpenAPI)
	- تکمیل: Route آپلود تصویر `POST /arshline/v1/upload`
۱۳. تست واحد، یکپارچه و امنیتی، Security Review در هر ماژول، مستندسازی کامل
	- برنامه: جایگزینی پنجره تایید پیش‌فرض با مودال سفارشی و انیمیشن reflow همسایه‌ها هنگام درگ
۱۴. بسته‌بندی و انتشار افزونه (ZIP امضا شده، صفحه What’s New، Telemetry اختیاری)

## نقاط عطف
- نهایی‌سازی معماری سیستم و شِمای پایگاه داده
- اسکلت اولیه افزونه و ساختار پوشه‌ها و رجیستری مرکزی
- نسخه MVP Core (تعریف فرم ساده، ذخیره، اعتبارسنجی، Queue)
- نسخه MVP فرم‌ساز بصری (درگ و دراپ، HTMX، فیلدهای پیشرفته، Undo/Redo)
	- دستاورد: درگ‌انداپ نرم + حفظ ترتیب پایدار، ابزارهای ثابت، حذف تکی/گروهی، پیش‌نمایش، مسیریابی Hash
- پیاده‌سازی فرم‌های شرطی، چندمرحله‌ای، زمان‌بندی و محدودیت تعداد
- پیاده‌سازی خروجی و اشتراک‌گذاری امن با Export Pipeline و سینک Google
- یکپارچه‌سازی ماژول‌های هوش مصنوعی، پیامک و تقویم
- آماده‌سازی داشبورد اختصاصی افزونه (نسخه‌دار و مستقل از داشبورد وردپرس)
- طراحی داشبورد بسیار مدرن و زیبا با Placeholder همه امکانات افزونه (اولویت اول توسعه)
- آماده‌سازی داشبورد تحلیلی هوشمند و سازنده قالب
- توسعه و مستندسازی کامل API داینامیک و Hook System
- پوشش کامل تست و بررسی امنیتی در هر ماژول
- تکمیل مستندات فنی و کاربری و صفحه What’s New
- آماده‌سازی نسخه انتشار و بسته‌بندی نهایی

# نقشه راه توسعه (Roadmap)

## فاز بعدی توسعه (پس از v1.5)

1. تکمیل فرم‌ساز بصری
   - افزودن فیلدهای شرطی و چندمرحله‌ای (Wizard/Stepper)
   - Undo/Redo و Draft/Publish برای فرم‌ها
   - قالب‌ساز فرم (ویرایشگر هدر/فوتر/لوگو و ذخیره قالب‌های آماده)

2. داشبورد تحلیلی و گزارش‌گیری
   - نمایش آمار ارسال‌ها، نمودارها و فیلترهای پیشرفته
   - خروجی امن به Excel/CSV/PDF و سینک با Google Sheets

3. یکپارچه‌سازی هوش مصنوعی
   - پیشنهاد خودکار فیلدها و گزینه‌ها بر اساس داده‌های قبلی
   - خلاصه‌سازی پاسخ‌ها و ارائه Insight هوشمند

4. امنیت و اعتبارسنجی پیشرفته
   - Rate Limiting، Honeypot، reCAPTCHA
   - تست‌های امنیتی و Privacy-by-Design

5. توسعه API و اکوسیستم
   - مستندسازی کامل REST API با Swagger/OpenAPI
   - افزودن Webhook و Hook System برای توسعه‌دهندگان

6. ابزارهای توسعه و CI
   - تست‌های واحد و یکپارچه بیشتر
   - راه‌اندازی CI/CD برای انتشار خودکار و بررسی کیفیت کد

---

برای هر بخش، چک‌لیست‌های عملیاتی در CHECKLIST.md ثبت می‌شود.
